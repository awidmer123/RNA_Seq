---
title: "The Role of Interferon Signaling in the Pulmonary Immune Response"
subtitle: "RNA Sequencing 2025"
author: "Andri L. Widmer  20-105-581"
format:
  pdf:
    crossref:
      fig-prefix: "Figure"
      tbl-prefix: "Table"
    include-in-header:
      text: |
        \usepackage{float}
        \usepackage{placeins}
---

## Abstract
Interferon signaling is a central component of host defense against intracellular pathogens. In this study, RNA-seq data from lung tissue of wild-type and double knockout mice were analyzed to investigate genotype-dependent transcriptional responses to infection. After rigorous quality assessment confirming high data integrity, exploratory analyses revealed clear clustering of samples by both infection status and genotype, indicating strong biologically driven effects. Differential expression analysis showed robust induction of immune-related genes in infected wild-type mice, particularly genes associated with interferon-regulated pathways. In contrast, the same genes were largely not differentially expressed in infected double knockout animals. Direct comparison of infected wild-type and knockout samples further demonstrated pronounced overexpression of interferon pathway genes in wild-type mice. Gene Ontology enrichment analysis supported these findings, with immune-related terms prominently enriched in comparisons involving wild-type infection but largely absent in the knockout condition. Together, these results indicate that intact type I and type II interferon signaling is essential for mounting a coordinated transcriptional immune response to infection, and that disruption of this axis leads to a profound loss of immune gene activation despite pathogen exposure.

## 1. Introduction
Toxoplasma gondii is an obligate intracellular protozoan parasite capable of infecting a wide range of warm-blooded hosts, including humans. Infection with T. gondii elicits strong host immune responses and can lead to pronounced inflammation, particularly during acute stages of infection (Dubey, 2016). Effective control of this pathogen relies heavily on coordinated innate and adaptive immune mechanisms, with interferon signalling playing a central role in host defence against intracellular parasites.

Although T. gondii can disseminate systemically, the lung represents a particularly relevant tissue for studying infection-induced immune responses. Pulmonary infection is associated with strong immune activation and inflammatory signalling, making lung tissue a suitable model for investigating transcriptional changes during host–pathogen interactions (Dubey, 2016).

Type I and type II interferons are key mediators of anti-parasitic immunity and inflammation. While type I interferons primarily modulate early innate immune responses, type II interferon (interferon-γ) is essential for activating macrophages and restricting intracellular pathogen replication. Disruption of these pathways is therefore expected to substantially alter transcriptional programmes during infection (Janeway and Medzhitov, 2002).

RNA sequencing (RNA-Seq) enables unbiased, genome-wide quantification of gene expression and has become a standard approach for analysing transcriptional responses across biological conditions (Wang et al., 2009). Owing to its sensitivity and broad dynamic range, RNA-Seq is especially well suited for studying complex immune responses, where coordinated regulation of large gene sets is expected (Conesa et al., 2016).

The RNA-Seq data analysed in this project originate from a study by Singhania et al., which comprehensively investigated immune responses to T. gondii infection in mice with different genetic backgrounds. In that study, wild-type (WT) animals were compared to a double knockout (DKO) model lacking both the type I interferon receptor (Ifnar⁻/⁻) and the type II interferon receptor (Ifngr⁻/⁻), enabling a broad analysis of interferon-dependent transcriptional responses to infection across multiple tissues.

In this practical course, RNA-Seq subsamples derived from the experimental setup of Singhania et al. were provided by the university and re-analysed. The present project focuses specifically on lung tissue and aims to compare bulk transcriptional responses between infected (“case”) and uninfected (“control”) samples in WT and DKO mice. By analysing the two genotypes separately, this study seeks to assess how the absence of both type I and type II interferon signalling influences the magnitude and nature of infection-induced gene expression changes in the lung.

The overall aim of this project was to compare lung-specific transcriptional responses to Toxoplasma gondii infection between wild-type and interferon receptor–deficient mice. The analysis follows an exploratory approach to characterise how disruption of type I and type II interferon signalling affects infection-induced gene expression in lung tissue. To this end, a standard RNA-Seq analysis workflow was applied, including quality control of sequencing data, read alignment to a reference genome, gene-level quantification, and statistical testing for differential expression. Emphasis was placed on reproducibility, appropriate statistical analysis, and careful assessment of data quality to enable a robust comparison of transcriptional responses between genotypes.


## 2. Materials and Methods

### 2.1 Dataset and experimental design

This project analysed strand-specific, paired-end Illumina HiSeq 4000 RNA-seq data derived from lung tissue of mice representing two genotypes: wildtype (WT) and interferon alpha/gamma receptor double knockout (DKO). For each genotype, both uninfected control animals and *Toxoplasma gondii*–infected mice were included, with 3–5 biological replicates per condition. The FASTQ files used in this analysis correspond to a subset of samples generated in the study by Singhania et al. (2019) and were accessed on the IBU cluster under `/data/courses/rnaseq_course/toxoplasma_de`. All scripts and code used throughout the workflow are available in the public GitHub repository: <https://github.com/awidmer123/RNA_Seq>. The general workflow could be found in the GitHub repository at ´resources/DEAnalysisWordflow.html´.

### 2.2 Computational environment and workflow organisation

All computationally intensive steps were executed on the IBU high-performance computing cluster using the Slurm workload manager. A structured project directory was created under `/data/users/awidmer/RNA_Seq`, following a consistent organisation by analysis step (quality control, alignment, BAM processing, and read counting).

To ensure full reproducibility, all tools were run inside predefined Apptainer containers, which provide stable versions of all required software independent of system configuration. Containerised versions of FastQC, HISAT2, SAMtools, and featureCounts were used throughout the workflow. MultiQC was used to aggregate quality control metrics across samples.

Detailed software versions for all cluster-based tools as well as R, Bioconductor, and the R packages used for downstream analysis are documented in the project repository under `results/versions/`. This includes the exact versions of FastQC, HISAT2, SAMtools, featureCounts, MultiQC, R, Bioconductor, and all relevant R packages to ensure full reproducibility of the analysis.

### 2.3 Quality control of raw sequencing reads

Initial quality assessment of the raw FASTQ files was performed using FastQC, which provided information on sequencing depth, per-base quality profiles for both mates, GC content, and the presence of adapter-derived sequences. The individual reports were merged using MultiQC to obtain an overview across all samples. No severe quality issues were detected, and all samples exhibited consistently high base qualities along the read length. As a result, no trimming or preprocessing was performed prior to alignment.

### 2.4 Reference genome acquisition and index preparation

The *Mus musculus* reference genome (GRCm39) and corresponding GTF annotation were downloaded from the Ensembl FTP server, following workflow recommendations. Integrity of both files was verified via checksum comparison using the `sum` utility. The FASTA file was subsequently used to build a HISAT2 genome index, which is required for performing splice-aware alignment of the RNA-seq reads.

### 2.5 Read alignment with HISAT2 and BAM processing with Samtools

Reads from each sample were aligned individually to the reference genome using HISAT2 executed via its Apptainer container. Resource usage followed the recommended cluster settings. Alignment produced SAM output files, which were converted into BAM format using Samtools. Post-alignment processing involved three standard Samtools operations: (i) conversion of SAM to BAM using `samtools view`; (ii) coordinate sorting of each BAM file using `samtools sort`; and (iii) index generation using `samtools index`. Sorted and indexed BAM files are required for efficient downstream processing, in particular for accurate read counting. All operations completed successfully using the recommended memory allocations for the IBU cluster.
Mapping quality metrics—such as alignment rate, proportion of properly paired reads, and frequency of multimappers, were inspected for each sample to confirm the overall quality of the alignment process.

### 2.6 Gene-level quantification with featureCounts

Gene-level read quantification was performed using featureCounts from the Subread package. The Ensembl GTF annotation was provided to define gene boundaries, and counting was conducted in paired-end and strand-specific mode to match the library preparation protocol. The resulting count table included one column per sample and reported the number of reads unambiguously assigned to each gene. FeatureCounts summary statistics, such as the number of assigned and unassigned reads and the fraction of multimapping or ambiguous alignments, were reviewed to ensure successful quantification.

### 2.7 Data processing and normalization in R

Downstream analysis was conducted locally in RStudio using the DESeq2 package. The featureCounts output was imported, and non-quantitative annotation columns (chromosome, start, end, strand, length) were removed. A `DESeqDataSet` object was created using a design formula modelling the experimental condition, which encoded each sample as WT_Control, WT_Case, DKO_Control, or DKO_Case.

DESeq2’s internal filtering removed genes with insufficient read support. Library size differences were normalised via DESeq2’s size-factor estimation. For exploratory analysis, a regularized log transformation (rlog) was applied.

### 2.8 Exploratory data analysis and Differential expression analysis

Principal component analysis (PCA) and sample-to-sample distance heatmaps were generated using VST-transformed counts. These visualisations revealed how samples cluster based on their global gene expression profiles and allowed the assessment of replicate consistency and separation of experimental groups.

Differential expression analysis was performed using DESeq2’s Wald test. Two contrasts were evaluated independently: (i) WT Case vs WT Control, and (ii) DKO Case vs DKO Control. Genes were considered differentially expressed at a false discovery rate of `padj < 0.05`. No additional log2 fold-change threshold was applied. For each contrast, the total number of significant differentially expressed genes (DEGs) as well as the counts of up- and down-regulated genes were recorded. Normalised counts of selected biologically relevant genes were inspected to support interpretation of genotype-specific responses.

### 2.9 Gene Ontology enrichment analysis

Functional enrichment analysis was conducted using the clusterProfiler package, specifically the `enrichGO` function. The list of differentially expressed genes (Ensembl IDs) served as input, while the set of all detected genes formed the universe background. The *Mus musculus* annotation database `org.Mm.eg.db` provided the necessary GO mappings. The Biological Process (BP) ontology was examined, and resulting GO terms were summarised and visualised using standard clusterProfiler plotting functions. Interpretation focused on immune-related processes known to be involved in *Toxoplasma* infection and interferon signalling based on Singhania et al. (2019).

## 3. Results
### 3.1 Quality control and read alignment
Quality control of the raw sequencing data was performed using *MultiQC*. Assignment rates ranged from 64 to 76 % for 14 samples, while one sample exhibited a lower assignment rate of 59.9 %. Overall sequence quality metrics were high and no major outlier samples were detected. However, *Per Base Sequence Content* analysis revealed pronounced nucleotide composition bias at the beginning of reads across all samples. Specifically, the first \~10–15 bases showed strong deviations from equal base representation, after which nucleotide frequencies stabilized along the remainder of the read length. This pattern was consistent across all libraries and is characteristic of RNA-seq data, likely reflecting library preparation–associated biases rather than technical artifacts. Consequently, all samples were retained for downstream analyses. The full MultiQC report is available in the GitHub repository at `results/multiqc_report_1.html`.

### 3.2 Exploratory data analysis

```{r}
#| label: setup
#| include: false

#loading BiocManager
if (!require("BiocManager", quietly = TRUE))
  install.packages("BiocManager")
  
library(BiocManager)

#loading packages
BiocManager::install("clusterProfiler", update = FALSE, ask = FALSE)
BiocManager::install("org.Mm.eg.db")
BiocManager::install('EnhancedVolcano')
install.packages("enrichplot")

library(EnhancedVolcano)
library(ggplot2)
library(DESeq2)
library(pheatmap)
library(ggplot2)
library(clusterProfiler)
library(org.Mm.eg.db)
library(enrichplot)
```

```{r}
#| label: unique-figure-design
#| include: false


#loading necessary packages
library(dplyr)
library(knitr)
library(kableExtra)

panel_theme_volcano <- theme_minimal(base_size = 20) +
  theme(
    plot.title = element_blank(),
    axis.title = element_text(size = 20),
    axis.text  = element_text(size = 18),
    legend.title = element_text(size = 18),
    legend.text  = element_text(size = 16),
    panel.grid.minor = element_blank(),
    legend.position = "bottom"   # ok für volcano (wenn’s passt)
  )

panel_theme_go <- theme_minimal(base_size = 20) +
  theme(
    plot.title = element_blank(),
    axis.title = element_text(size = 20),
    axis.text  = element_text(size = 18),
    legend.title = element_text(size = 18),
    legend.text  = element_text(size = 16),
    panel.grid.minor = element_blank(),
    legend.position = "right",   # <-- wichtig
    legend.direction = "vertical"
  )


```

```{r}
#| label: DeSeq2-setup
#| include: false
counts <- read.table("counts2.txt", header = TRUE, row.names = 1)
groups_info <- read.table("groups_info.txt")
names(groups_info) <- c("label", "condition")

counts_cut <- counts[, 6:ncol(counts)]

counts_dds <- DESeqDataSetFromMatrix(
countData = counts_cut,
colData   = groups_info,
design    = ~ condition
)

counts_dds_DESeq <- DESeq(counts_dds)
counts_dds_rlog  <- rlog(counts_dds_DESeq)
```

```{r}
#| label: making-pca-plot
#| include: false

pca_plot <- plotPCA(counts_dds_rlog, intgroup = "condition") +
  theme_bw() +
  labs(
    title = "PCA of rlog-transformed counts",
    x = "PC1",
    y = "PC2"
  ) +
  theme(
    plot.title = element_text(size = 22, face = "bold"),
    axis.title = element_text(size = 20),
    axis.text  = element_text(size = 18),
    legend.title = element_text(size = 18),
    legend.text  = element_text(size = 16)
)
```

```{r}
#| label: heatmap-setup
#| include: false

mat <- assay(counts_dds_rlog)

# calculate variance per gene
gene_vars <- apply(mat, 1, var)

# keep the top 50 most variable genes
top_genes <- order(gene_vars, decreasing = TRUE)[1:100]
mat_top <- mat[top_genes, ]

#building a proper annotation data frame
annotation_df <- as.data.frame(colData(counts_dds_DESeq)[, "condition", drop = FALSE])

# Very important: rownames must match the samples in mat_top
rownames(annotation_df) <- colnames(mat_top)



heatmap <- pheatmap(
  mat_top,
  annotation_col = annotation_df,
  scale = "row",
  clustering_distance_rows = "euclidean",
  clustering_distance_cols = "euclidean",
  clustering_method = "complete",
  show_rownames = FALSE,
  fontsize = 18,
  fontsize_col = 18,
)

```

```{r}
#| label: fig-pca-hm
#| echo: false
#| layout-ncol: 2
#| fig-cap: "PCA and Heatmap"
#| fig-subcap: ["PCA", "Heatmap of top 100 variable genes"]
#| fig-pos: "H"
#| fig-width: 12
#| fig-height: 8
#| out-width: "100%"

pca_plot
grid::grid.newpage()
grid::grid.draw(heatmap$gtable)
```

\FloatBarrier

As shown in @fig-pca-hm (a), samples cluster according to both genotype and infection status. WT and DKO samples separate along the first principal component, while infected and control samples show additional separation along the second component. Biological replicates group closely together, indicating good reproducibility and low within-group variability.

Figure @fig-pca-hm (b) shows the expression patterns of the 20 most variable genes across all samples. Hierarchical clustering reveals a clear separation of samples according to genotype and infection status. Replicates within the same condition cluster closely together, while distinct expression profiles are observed between WT and DKO samples.
\FloatBarrier

```{r}
#| label: preparing results tables
#| include: false


#data for differential gene analysis
WT_con_VS_WT_case <- results(counts_dds_DESeq, contrast = c("condition", "Lung_WT_Case", "Lung_WT_Control"))

DKO_con_VS_DKO_case <- results(counts_dds_DESeq, contrast = c("condition", "Lung_DKO_Case", "Lung_DKO_Control"))

WT_case_VS_DKO_case <- results(counts_dds_DESeq, contrast = c("condition", "Lung_DKO_Case", "Lung_WT_Case"))
```

```{r}
#| label: Important genes
#| include: false


#setting up working directory
setwd("/home/andri/Desktop/UNIFR/2_Bioinf/RNA_Sequencing")

#loading and modifying data
module_df <- read.table("Lung modules.csv",sep = ",")
colnames(module_df) <- c("ensembl_id", "Gene.name", "Module")

#------------------FUNCTIONS-------------------------------------------

# 1. defining function that annotates modules
res_to_annot <- function(res_obj, module_Fdf) {
  as.data.frame(res_obj) %>%
    tibble::rownames_to_column("ensembl_id") %>%
    filter(!is.na(padj), !is.na(log2FoldChange)) %>%     
    left_join(module_df, by = "ensembl_id")
}

# 2. defining function that picks interesting candidates
pick_candidates <- function(df, label, padj_cutoff = 0.05, lfc_cutoff = 1, top_n = 10) {
  df %>%
    mutate(is_ifn = gene_name %in% ifn_immune_genes) %>%
    filter(padj < padj_cutoff, abs(log2FoldChange) >= lfc_cutoff) %>%
    arrange(desc(is_ifn), padj, desc(abs(log2FoldChange))) %>%
    mutate(contrast = label) %>%
    select(contrast, ensembl_id, gene_name, module, baseMean, log2FoldChange, padj, is_ifn) %>%
    head(top_n)
}
#----------------------------------------------------------------------

#transmute module dataframe
module_df <- module_df %>%
  transmute(
    ensembl_id = ensembl_id,
    gene_name = Gene.name,
    module = Module
  )

#using "res_to_annot" function
wt_annot  <- res_to_annot(WT_con_VS_WT_case, module_df)
dko_annot <- res_to_annot(DKO_con_VS_DKO_case, module_df)
wt_dko_annot <- res_to_annot(WT_case_VS_DKO_case, module_df)


#classical from literature derived genes that are involved in immune response and ifn related
ifn_immune_genes <- c(
  "Ifit1","Ifit2","Ifit3","Isg15","Rsad2","Mx1","Mx2",
  "Oas1a","Oas1g","Oas2","Oas3","Oasl1","Oasl2",
  "Irf7","Irf9","Stat1","Stat2","Usp18","Ddx58","Ifih1","Zbp1",
  "Cxcl9","Cxcl10","Tap1","Tap2","B2m","Psmb8","Psmb9","Nlrc5",
  "Gbp2","Gbp3","Gbp5","Gbp6","Gbp7","Gbp10",
  "Il1b"
)


#using the pick_candidates function to select for intersting hits
wt_hits  <- pick_candidates(wt_annot,  "WT: infected vs control")
dko_hits <- pick_candidates(dko_annot, "DKO: infected vs control")
wt_dko_hits <- pick_candidates(wt_dko_annot, "WT infected vs DKO infected")

combined_hits <- rbind(wt_hits, dko_hits, wt_dko_hits)

```

```{r}
#| label: volcano-setup
#| include: false



# --- Map ENSMUSG -> gene symbol (English comments, <-) ---
lung_map <- read.csv("Lung modules.csv", header = FALSE, stringsAsFactors = FALSE)
colnames(lung_map) <- c("ensembl_id", "gene_name", "module")

ens2sym <- setNames(lung_map$gene_name, lung_map$ensembl_id)

# Helper: return a label vector matching rownames(res)
get_labels <- function(res, map_vec) {
  rn <- rownames(res)
  if (all(grepl("^ENSMUSG", rn))) {
    lab <- unname(map_vec[rn])
    lab[is.na(lab)] <- rn[is.na(lab)]  # fallback if unmapped
    return(lab)
  } else {
    return(rn) # already gene symbols (or something else readable)
  }
}

# --- Define the EXACT genes you want to label (from your Table 2 screenshot) ---
lab_WT <- wt_hits$gene_name

lab_DKO <- dko_hits$gene_name

lab_WTca_vs_DKOca <- wt_dko_hits$gene_name

# --- Build volcanoes with mapping + selectLab ---
Volcano_WT <- EnhancedVolcano(
  WT_con_VS_WT_case,
  lab = get_labels(WT_con_VS_WT_case, ens2sym),
  x = "log2FoldChange",
  y = "padj",
  title = NULL,
  selectLab = lab_WT,
  drawConnectors = TRUE,
  max.overlaps = Inf
) + panel_theme_volcano

Volcano_DKO <- EnhancedVolcano(
  DKO_con_VS_DKO_case,
  lab = get_labels(DKO_con_VS_DKO_case, ens2sym),
  x = "log2FoldChange",
  y = "padj",
  title = NULL,
  selectLab = lab_DKO,
  drawConnectors = TRUE,
  max.overlaps = Inf
) + panel_theme_volcano

Volcano_WTca_vs_DKOca <- EnhancedVolcano(
  WT_case_VS_DKO_case,
  lab = get_labels(WT_case_VS_DKO_case, ens2sym),
  x = "log2FoldChange",
  y = "padj",
  title = NULL,
  selectLab = lab_WTca_vs_DKOca,
  drawConnectors = TRUE,
  max.overlaps = Inf
) + panel_theme_volcano

```

```{r}
#| label: summary-table
#| include: false

# DE genes (padj < 0.05)
#extracting numbers
res_WT <- as.data.frame(WT_con_VS_WT_case)
de_WT <- res_WT[!is.na(res_WT$padj) & res_WT$padj < 0.05, ]

res_DKO <- as.data.frame(DKO_con_VS_DKO_case)
de_DKO <- res_DKO[!is.na(res_DKO$padj) & res_DKO$padj < 0.05, ]

res_WT_DKO <- as.data.frame(WT_case_VS_DKO_case)
de_WT_DKO <- res_WT_DKO[!is.na(res_WT_DKO$padj) & res_WT_DKO$padj < 0.05, ]

#creating summary table
summary_DE <- data.frame(
  Comparison = c("WT Control vs Case", "DKO Control vs Case", "WT Case vs DKO Case"),
  DE_genes = c(nrow(de_WT), nrow(de_DKO), nrow(de_WT_DKO)),
  Upregulated = c(
    sum(de_WT$log2FoldChange > 0),
    sum(de_DKO$log2FoldChange > 0),
    sum(de_WT_DKO$log2FoldChange > 0)
  ),
  Downregulated = c(
    sum(de_WT$log2FoldChange < 0),
    sum(de_DKO$log2FoldChange < 0),
    sum(de_WT_DKO$log2FoldChange > 0)
  )
)
```
\FloatBarrier

### 3.3 Differential gene expression analysis

```{r}
#| label: tbl-DE-genes
#| echo: false
#| tbl-cap: "Number of significantly differentially expressed genes (DEGs; padj < 0.05) identified for infection-induced contrasts within genotypes (WT control vs case, DKO control vs case) and for the direct comparison between infected WT and infected DKO samples. DEGs are further classified as up- or downregulated based on the sign of the log₂ fold change."

summary_DE |>
  dplyr::mutate(
    DE_genes = as.integer(DE_genes),
    Upregulated = as.integer(Upregulated),
    Downregulated = as.integer(Downregulated)
  ) |>
  knitr::kable(
    format = "latex",
    booktabs = TRUE
  ) |>
  kableExtra::kable_styling(
    latex_options = c("HOLD_position", "striped", "scale_down"),
    font_size = 9
  )

```
\FloatBarrier

As summarised in @tbl-DE-genes, infection induced widespread transcriptional changes in lung tissue in both WT and DKO mice, with more than 10,000 genes showing significant differential expression in each genotype. In contrast, the direct comparison between infected WT and infected DKO samples yielded a smaller, yet substantial, set of differentially expressed genes, indicating genotype-dependent differences in transcriptional responses specifically under infectious conditions.

```{r}
#| label: fig-volcano-panel
#| echo: false
#| layout-ncol: 2
#| fig-cap: "Volcano plots illustrating differential gene expression in lung tissue following Toxoplasma gondii infection. Shown are (a) WT control vs case, (b) DKO control vs case, and (c) WT case vs DKO case. Each point represents one gene; the x-axis shows log₂ fold change and the y-axis shows −log₁₀ adjusted p-values (DESeq2 Wald test). Labeled genes correspond to selected immune-related genes summarized in Table 2."
#| fig-subcap: ["WT control vs case", "DKO control vs case", "WT case vs DKO case"]
#| fig-pos: "H"
#| fig-width: 12
#| fig-height: 8
#| out-width: "100%"

Volcano_WT
Volcano_DKO
Volcano_WTca_vs_DKOca

```

As shown in @fig-volcano-panel (a), infection of WT mice leads to widespread transcriptional changes in lung tissue, with numerous genes displaying both large effect sizes and high statistical significance. This reflects a robust transcriptional response to T. gondii infection in WT animals.

In DKO mice @fig-volcano-panel (b), infection also results in extensive differential gene expression. Compared to WT mice, the overall distribution and magnitude of log₂ fold changes differ, suggesting that the absence of type I and type II interferon signalling alters the transcriptional response to infection.

Importantly, the direct comparison of infected WT and infected DKO samples in @fig-volcano-panel (c) reveals pronounced genotype-dependent differences under infectious conditions. A substantial number of genes show strong differential expression between the two genotypes, supporting the conclusion that interferon receptor deficiency markedly reshapes infection-induced transcriptional programmes in lung tissue.

### 3.4 Functional enrichment analysis

```{r}
#| label: enrichGO
#| include: false

# All genes, that were tested in DESeq2 analysisi
universe_genes <- rownames(counts_dds_DESeq)

# Getting the groups for comparison
res_WT <- WT_con_VS_WT_case
res_DKO <- DKO_con_VS_DKO_case
res_WT_DKO <- WT_case_VS_DKO_case


# Significant genes (padj < 0.05, ni NAs)
res_WT_sig <- res_WT[!is.na(res_WT$padj) & res_WT$padj < 0.05, ]
res_DKO_sig <- res_DKO[!is.na(res_DKO$padj) & res_DKO$padj < 0.05, ]
res_WT_DKO_sig <- res_WT_DKO[!is.na(res_WT_DKO$padj) & res_WT_DKO$padj < 0.05, ]


de_genes_WT <- rownames(res_WT_sig)  # Ensembl-IDs der DE-Gene
de_genes_DKO <- rownames(res_DKO_sig)
de_genes_WT_DKO <- rownames(res_WT_DKO_sig)

ego_WT_BP <- enrichGO(
  gene          = de_genes_WT,      # DE genes
  universe      = universe_genes,   # all tested genes
  OrgDb         = org.Mm.eg.db,     # Mouse Annotation
  keyType       = "ENSEMBL",        # format of IDs
  ont           = "BP",             # "BP", "MF", "CC" or "ALL"
  pAdjustMethod = "BH",
  pvalueCutoff  = 0.05,
  qvalueCutoff  = 0.2,
  readable      = TRUE              # mapping Ensembl -> Gene Symbols
)

ego_DKO_BP <- enrichGO(
  gene          = de_genes_DKO,      # DE genes
  universe      = universe_genes,   # all tested genes
  OrgDb         = org.Mm.eg.db,     # Mouse Annotation
  keyType       = "ENSEMBL",        # format of IDs
  ont           = "BP",             # "BP", "MF", "CC" or "ALL"
  pAdjustMethod = "BH",
  pvalueCutoff  = 0.05,
  qvalueCutoff  = 0.2,
  readable      = TRUE              # mapping Ensembl -> Gene Symbols
)

ego_WT_DKO_BP <- enrichGO(
  gene          = de_genes_WT_DKO,      # DE genes
  universe      = universe_genes,   # all tested genes
  OrgDb         = org.Mm.eg.db,     # Mouse Annotation
  keyType       = "ENSEMBL",        # format of IDs
  ont           = "BP",             # "BP", "MF", "CC" or "ALL"
  pAdjustMethod = "BH",
  pvalueCutoff  = 0.05,
  qvalueCutoff  = 0.2,
  readable      = TRUE              # mapping Ensembl -> Gene Symbols
)

# Sort by adjusted p-value (most significant first)
ego_res <- ego_WT_BP@result[order(ego_WT_BP@result$p.adjust), ]
ego_res_DKO <- ego_DKO_BP@result[order(ego_DKO_BP@result$p.adjust),]
ego_res_WT_DKO <- ego_WT_DKO_BP@result[order(ego_WT_DKO_BP@result$p.adjust),]
# Keep only top 50 (adjust if you want 100)
ego_WT_BP_top <- ego_WT_BP
ego_WT_BP_top@result <- ego_res[1:50, ]

ego_DKO_BP_top <- ego_DKO_BP
ego_DKO_BP_top@result <- ego_res_DKO[1:50, ]

ego_DKO_WT_BP_top <- ego_WT_DKO_BP
ego_DKO_WT_BP_top@result <- ego_res_WT_DKO[1:50,]

#simplify GO term matrix to filter out redundancy
ego_WT_BP_s <- simplify(
  ego_WT_BP_top,
  measure = "Wang",
  cutoff = 0.7,
  by = "p.adjust",
  select_fun = min
)

ego_DKO_BP_s <- simplify(
  ego_DKO_BP_top,
  measure = "Wang",
  cutoff = 0.7,
  by = "p.adjust",
  select_fun = min
)

ego_WT_DKO_BP_s <- simplify(
  ego_DKO_WT_BP_top,
  measure = "Wang",
  cutoff = 0.7,
  by = "p.adjust",
  select_fun = min
)

barplot_ego_WT_BP_s <- barplot(ego_WT_BP_s, showCategory = 10) +
  panel_theme_go +
  theme(axis.text.y = element_text(size = 20))

barplot_ego_DKO_BP_s <- barplot(ego_DKO_BP_s, showCategory = 10) +
  panel_theme_go +
  theme(axis.text.y = element_text(size = 20))

barplot_ego_WT_DKO_BP_s <- barplot(ego_WT_DKO_BP_s, showCategory = 10) +
  panel_theme_go +
  theme(axis.text.y = element_text(size = 20))

```

```{r}
#| label: fig-go-bp-barplots
#| echo: false
#| fig-cap: "Gene Ontology (Biological Process) enrichment of significantly differentially expressed genes (padj < 0.05) in WT (a), DKO (b) and WT case vs DKO case (c) lung samples. Terms were simplified to reduce redundancy (Wang similarity, cutoff = 0.7)."
#| fig-subcap: ["WT control vs case", "DKO control vs case", "WT case vs DKO case"]
#| fig-pos: "H"
#| fig-width: 12
#| fig-height: 8
#| layout-ncol: 2
#| out-width: "100%"

barplot_ego_WT_BP_s
barplot_ego_DKO_BP_s
barplot_ego_WT_DKO_BP_s

```

\FloatBarrier

Gene Ontology (GO) enrichment analysis was performed on the sets of significantly differentially expressed genes to identify biological processes associated with infection- and genotype-dependent transcriptional changes (@fig-go-bp-barplots). In WT mice in @fig-go-bp-barplots (a), enriched Biological Process terms were predominantly related to immune activation, including leukocyte migration, chemotaxis, regulation of innate immune responses, and responses to biotic stimuli. These categories reflect a coordinated immune response to Toxoplasma gondii infection in lung tissue.

In DKO mice (@fig-go-bp-barplots b), differentially expressed genes were also enriched for immune- and inflammation-related processes; however, the enrichment profile differed from that observed in WT animals. In addition to leukocyte migration and cell–cell adhesion, terms associated with cytoskeletal organisation, muscle system processes, and wound healing were prominent, indicating an altered functional response to infection in the absence of type I and type II interferon signalling.

The direct comparison between infected WT and infected DKO samples (@fig-go-bp-barplots c) revealed enrichment of GO terms related to regulation of inflammatory responses, immune effector processes, chemotaxis, and cell activation. These enriched categories highlight genotype-dependent differences in the functional organisation of infection-induced transcriptional responses. Only the most significant non-redundant GO terms are shown following semantic similarity-based simplification.
\FloatBarrier

### 3.5 Comparison to Singhania et al. 

```{r}
#| label: tbl-important-genes
#| echo: false
#| tbl-cap: "Selected genes showing significant differential expression in WT control vs case, DKO control vs case, and WT case vs DKO case comparisons. Genes were selected based on adjusted p-values and log₂ fold changes and include interferon- and immune-related candidates previously reported in Singhania et al. (2019). For each gene, the corresponding contrast, Ensembl identifier, gene name, base mean expression, log₂ fold change, and adjusted p-value are shown."

combined_hits[,1:7]|>
  kable(
    format = "latex",
    booktabs = TRUE
  ) |>
  kable_styling(
    latex_options = c("hold_position", "striped", "scale_down"),
    font_size = 9
  )

```

\FloatBarrier

@tbl-important-genes highlights a subset of representative genes that are significantly differentially expressed across the analysed contrasts. The selected genes include multiple interferon-stimulated and immune-related transcripts, such as Tap1, Stat2, Irf7, and several Gbp family members, which show strong regulation upon infection. In addition, the direct comparison between infected WT and infected DKO samples reveals pronounced genotype-dependent differences for key immune effector genes. These examples illustrate how disruption of type I and type II interferon signalling alters infection-induced transcriptional responses in lung tissue.

## 4. Discussion

The quality assessment indicated high overall data quality, with no obvious technical outliers or batch effects detected. Principal component analysis and hierarchical clustering consistently revealed a clear separation of samples according to both infection status and genotype. This demonstrates that the dominant sources of variance in the dataset are biologically driven rather than technical, providing a robust foundation for downstream differential expression analyses.

Comparative analysis of gene expression further highlighted a pronounced genotype-dependent response to infection. In wild-type mice, infection induced strong and statistically significant upregulation of a broad set of immune-related genes. Many of these genes correspond to those previously described as part of immune response modules, particularly modules associated with type I interferon signaling and IFNγ/STAT1-mediated pathways. In contrast, the same genes were largely not differentially expressed in the double knockout condition, with only two genes reaching statistical significance. This indicates a substantial loss of coordinated immune gene induction in the absence of intact interferon signaling.

The direct comparison between infected wild-type and infected double knockout samples further reinforced this observation. Genes belonging to interferon-dependent pathways were consistently overexpressed in wild-type mice relative to knockout animals, underscoring the central role of interferon signaling in shaping the transcriptional immune response. Rather than reflecting a simple reduction in response magnitude, the knockout phenotype appears to represent a collapse of an interferon-driven transcriptional program, affecting both early innate signaling and downstream effector mechanisms.

Functional enrichment analysis supported these findings at a systems level. While comparisons involving wild-type infected samples were enriched for immune-related Gene Ontology terms such as cytokine signaling, interferon response, and antigen processing, these categories were markedly reduced or absent in the double knockout comparison. This qualitative shift suggests that residual transcriptional changes observed in the knockout background are not part of a coordinated immune response but may instead reflect nonspecific or secondary effects of infection.

Together, these results highlight the critical importance of both type I and type II interferon pathways in orchestrating effective host defense mechanisms. The absence of these signaling axes results in a failure to activate key immune genes despite pathogen exposure, emphasizing their indispensable role in initiating and amplifying immune responses. A limitation of this study is the use of bulk RNA-seq data, which does not allow cell-type–specific effects to be resolved. Future single-cell or time-resolved analyses would help disentangle cell-intrinsic transcriptional defects from potential differences in immune cell composition. Nonetheless, the present findings provide clear transcriptional evidence that interferon signaling is a central determinant of effective immune activation in this infection model.

### AI Usage
Artificial intelligence tools were used to support efficient code development and linguistic refinement of the manuscript. In particular, ChatGPT was employed to assist with code optimization, troubleshooting, and stylistic polishing of the written text.

### References

Conesa, A. et al. (2016) “A survey of best practices for RNA-seq data analysis,” Genome Biology, 17(1), p. 13. Available at: https://doi.org/10.1186/s13059-016-0881-8.

Dubey, J.P. (2016) Toxoplasmosis of Animals and Humans. 0 ed. CRC Press. Available at: https://doi.org/10.1201/9781420092370.

Janeway, C.A. and Medzhitov, R. (2002) “Innate Immune Recognition,” Annual Review of Immunology, 20(1), pp. 197–216. Available at: https://doi.org/10.1146/annurev.immunol.20.083001.084359.

Singhania, A. et al. (2019) “Transcriptional profiling unveils type I and II interferon networks in blood and tissues across diseases,” Nature Communications, 10(1), p. 2887. Available at: https://doi.org/10.1038/s41467-019-10601-6.

Wang, Z., Gerstein, M. and Snyder, M. (2009) “RNA-Seq: a revolutionary tool for transcriptomics,” Nature Reviews Genetics, 10(1), pp. 57–63. Available at: https://doi.org/10.1038/nrg2484.

